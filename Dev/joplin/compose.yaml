---
# ===========================================================================================
# Title   Joplin
# Created By: PJ Guibord
# Date 01/16/2025
# Revision: n/a
# Version: 1.0
# LINKS: n/a
# ===========================================================================================
# Revision History:
#   - 1.0: Initial Release
# ===========================================================================================

# docker run -p <HostPort:containerport> imagename:tag

# Start containers:: 
#   docker compose up --detach

services:
  joplin:
    container_name: ${container_name}
    image: ${image}
    restart: unless-stopped
    ports:
      - '${joplin_port}:22300'
    environment:
      MAX_TIME_DRIFT: 0
      #APP_Base_URL: ${joplin_url}
      APP_Base_URL: '10.252.252.77'
      TZ: ${time_zone}
      NTP_SERVER: 10.252.252.77:123
      # Postgres Config
      DB_CLIENT: pg
      POSTGRES_DATABASE: ${joplin_db}
      POSTGRES_USER: ${joplin_db_un}
      POSTGRES_PASSWORD: ${joplin_db_pw}
      POSTGRES_HOST: ${joplin_db_server}
      POSTGRES_PORT: ${joplin_db_port}
      # TRANSCRIBE_API_KEY: ${TRANSCRIBE_API_KEY}
      # TRANSCRIBE_BASE_URL: http://transcribe:4567
      # TRANSCRIBE_ENABLED: ${TRANSCRIBE_ENABLED}
      # =====================================
      # External storage
      #STORAGE_DRIVER: Type=Filesystem; Path=/path/to/dir
      # http://localhost:22300/api/ping`‚Å†
#
#
  # transcribe-db:
  #       image: postgres:16
  #       profiles:
  #           - full
  #       volumes:
  #           - ./data/transcribe-postgres:/var/lib/postgresql/data
  #       networks:
  #           - transcribe-network
  #       ports:
  #           - "${QUEUE_DATABASE_PORT}:5432"
  #       restart: unless-stopped
  #       environment:
  #           - POSTGRES_PASSWORD=${QUEUE_DATABASE_PASSWORD}
  #           - POSTGRES_USER=${QUEUE_DATABASE_USER}
  #           - POSTGRES_DB=${QUEUE_DATABASE_NAME}
  #       command: -p ${QUEUE_DATABASE_PORT}
  #
  #
  # transcribe:
  #       image: joplin/transcribe:latest
  #       profiles:
  #           - full
  #       volumes:
  #           - /var/run/docker.sock:/var/run/docker.sock
  #           - ${HTR_CLI_IMAGES_FOLDER}:/app/packages/transcribe/images
  #       depends_on:
  #           - transcribe-db
  #       ports:
  #           - "4567:4567"
  #       networks:
  #           - transcribe-network
  #           - shared-network
  #       restart: unless-stopped
  #       environment:
  #           - APP_PORT=4567
  #           - DB_CLIENT=pg
  #           - QUEUE_DATABASE_NAME=${QUEUE_DATABASE_NAME}
  #           - QUEUE_DATABASE_USER=${QUEUE_DATABASE_USER}
  #           - QUEUE_DATABASE_PASSWORD=${QUEUE_DATABASE_PASSWORD}
  #           - QUEUE_DATABASE_PORT=${QUEUE_DATABASE_PORT}
  #           - QUEUE_DATABASE_HOST=transcribe-db
  #           - API_KEY=${TRANSCRIBE_API_KEY}
  #           - HTR_CLI_IMAGES_FOLDER=${HTR_CLI_IMAGES_FOLDER}